.. -*- coding: utf-8; mode: rst -*-
.. src-file: net/netlabel/netlabel_cipso_v4.c

.. _`netlbl_cipsov4_add_common`:

netlbl_cipsov4_add_common
=========================

.. c:function:: int netlbl_cipsov4_add_common(struct genl_info *info, struct cipso_v4_doi *doi_def)

    Parse the common sections of a ADD message

    :param struct genl_info \*info:
        the Generic NETLINK info block

    :param struct cipso_v4_doi \*doi_def:
        the CIPSO V4 DOI definition

.. _`netlbl_cipsov4_add_common.description`:

Description
-----------

Parse the common sections of a ADD message and fill in the related values
in \ ``doi_def``\ .  Returns zero on success, negative values on failure.

.. _`netlbl_cipsov4_add_std`:

netlbl_cipsov4_add_std
======================

.. c:function:: int netlbl_cipsov4_add_std(struct genl_info *info, struct netlbl_audit *audit_info)

    Adds a CIPSO V4 DOI definition

    :param struct genl_info \*info:
        the Generic NETLINK info block

    :param struct netlbl_audit \*audit_info:
        NetLabel audit information

.. _`netlbl_cipsov4_add_std.description`:

Description
-----------

Create a new CIPSO_V4_MAP_TRANS DOI definition based on the given ADD
message and add it to the CIPSO V4 engine.  Return zero on success and
non-zero on error.

.. _`netlbl_cipsov4_add_pass`:

netlbl_cipsov4_add_pass
=======================

.. c:function:: int netlbl_cipsov4_add_pass(struct genl_info *info, struct netlbl_audit *audit_info)

    Adds a CIPSO V4 DOI definition

    :param struct genl_info \*info:
        the Generic NETLINK info block

    :param struct netlbl_audit \*audit_info:
        NetLabel audit information

.. _`netlbl_cipsov4_add_pass.description`:

Description
-----------

Create a new CIPSO_V4_MAP_PASS DOI definition based on the given ADD message
and add it to the CIPSO V4 engine.  Return zero on success and non-zero on
error.

.. _`netlbl_cipsov4_add_local`:

netlbl_cipsov4_add_local
========================

.. c:function:: int netlbl_cipsov4_add_local(struct genl_info *info, struct netlbl_audit *audit_info)

    Adds a CIPSO V4 DOI definition

    :param struct genl_info \*info:
        the Generic NETLINK info block

    :param struct netlbl_audit \*audit_info:
        NetLabel audit information

.. _`netlbl_cipsov4_add_local.description`:

Description
-----------

Create a new CIPSO_V4_MAP_LOCAL DOI definition based on the given ADD
message and add it to the CIPSO V4 engine.  Return zero on success and
non-zero on error.

.. _`netlbl_cipsov4_add`:

netlbl_cipsov4_add
==================

.. c:function:: int netlbl_cipsov4_add(struct sk_buff *skb, struct genl_info *info)

    Handle an ADD message

    :param struct sk_buff \*skb:
        the NETLINK buffer

    :param struct genl_info \*info:
        the Generic NETLINK info block

.. _`netlbl_cipsov4_add.description`:

Description
-----------

Create a new DOI definition based on the given ADD message and add it to the
CIPSO V4 engine.  Returns zero on success, negative values on failure.

.. _`netlbl_cipsov4_list`:

netlbl_cipsov4_list
===================

.. c:function:: int netlbl_cipsov4_list(struct sk_buff *skb, struct genl_info *info)

    Handle a LIST message

    :param struct sk_buff \*skb:
        the NETLINK buffer

    :param struct genl_info \*info:
        the Generic NETLINK info block

.. _`netlbl_cipsov4_list.description`:

Description
-----------

Process a user generated LIST message and respond accordingly.  While the
response message generated by the kernel is straightforward, determining
before hand the size of the buffer to allocate is not (we have to generate
the message to know the size).  In order to keep this function sane what we
do is allocate a buffer of NLMSG_GOODSIZE and try to fit the response in
that size, if we fail then we restart with a larger buffer and try again.
We continue in this manner until we hit a limit of failed attempts then we
give up and just send an error message.  Returns zero on success and
negative values on error.

.. _`netlbl_cipsov4_listall_cb`:

netlbl_cipsov4_listall_cb
=========================

.. c:function:: int netlbl_cipsov4_listall_cb(struct cipso_v4_doi *doi_def, void *arg)

    cipso_v4_doi_walk() callback for LISTALL

    :param struct cipso_v4_doi \*doi_def:
        the CIPSOv4 DOI definition

    :param void \*arg:
        the netlbl_cipsov4_doiwalk_arg structure

.. _`netlbl_cipsov4_listall_cb.description`:

Description
-----------

This function is designed to be used as a callback to the
\ :c:func:`cipso_v4_doi_walk`\  function for use in generating a response for a LISTALL
message.  Returns the size of the message on success, negative values on
failure.

.. _`netlbl_cipsov4_listall`:

netlbl_cipsov4_listall
======================

.. c:function:: int netlbl_cipsov4_listall(struct sk_buff *skb, struct netlink_callback *cb)

    Handle a LISTALL message

    :param struct sk_buff \*skb:
        the NETLINK buffer

    :param struct netlink_callback \*cb:
        the NETLINK callback

.. _`netlbl_cipsov4_listall.description`:

Description
-----------

Process a user generated LISTALL message and respond accordingly.  Returns
zero on success and negative values on error.

.. _`netlbl_cipsov4_remove_cb`:

netlbl_cipsov4_remove_cb
========================

.. c:function:: int netlbl_cipsov4_remove_cb(struct netlbl_dom_map *entry, void *arg)

    netlbl_cipsov4_remove() callback for REMOVE

    :param struct netlbl_dom_map \*entry:
        LSM domain mapping entry

    :param void \*arg:
        the netlbl_domhsh_walk_arg structure

.. _`netlbl_cipsov4_remove_cb.description`:

Description
-----------

This function is intended for use by \ :c:func:`netlbl_cipsov4_remove`\  as the callback
for the \ :c:func:`netlbl_domhsh_walk`\  function; it removes LSM domain map entries
which are associated with the CIPSO DOI specified in \ ``arg``\ .  Returns zero on
success, negative values on failure.

.. _`netlbl_cipsov4_remove`:

netlbl_cipsov4_remove
=====================

.. c:function:: int netlbl_cipsov4_remove(struct sk_buff *skb, struct genl_info *info)

    Handle a REMOVE message

    :param struct sk_buff \*skb:
        the NETLINK buffer

    :param struct genl_info \*info:
        the Generic NETLINK info block

.. _`netlbl_cipsov4_remove.description`:

Description
-----------

Process a user generated REMOVE message and respond accordingly.  Returns
zero on success, negative values on failure.

.. _`netlbl_cipsov4_genl_init`:

netlbl_cipsov4_genl_init
========================

.. c:function:: int netlbl_cipsov4_genl_init( void)

    Register the CIPSOv4 NetLabel component

    :param  void:
        no arguments

.. _`netlbl_cipsov4_genl_init.description`:

Description
-----------

Register the CIPSOv4 packet NetLabel component with the Generic NETLINK
mechanism.  Returns zero on success, negative values on failure.

.. This file was automatic generated / don't edit.

